<UserControl x:Class="ManagementFile.App.Controls.UserMenuPopup"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ManagementFile.App.Controls"
             mc:Ignorable="d">
    <UserControl.Resources>
        <!-- Drop Shadow Effect -->
        <DropShadowEffect x:Key="DropShadowEffect" 
                        BlurRadius="15" 
                        ShadowDepth="3" 
                        Opacity="0.3" 
                        Color="#000000"/>

        <!-- Button Style -->
        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                            VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F5F5F5"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#EEEEEE"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Border Background="White"
            BorderBrush="#E0E0E0"
            BorderThickness="1"
            CornerRadius="8"
            Padding="0"
            Effect="{StaticResource DropShadowEffect}">

        <StackPanel MinWidth="220">
            <!-- User Info Header -->
            <Border Background="#F8F9FA" 
                    Padding="20,15"
                    BorderBrush="#E0E0E0"
                    BorderThickness="0,0,0,1">
                <StackPanel>
                    <TextBlock Text="Tài khoản" 
                             FontSize="11"
                             Foreground="#666666"
                             Margin="0,0,0,4"/>
                    <TextBlock Text="{Binding CurrentUserName}" 
                             FontSize="14"
                             FontWeight="SemiBold"
                             Foreground="#333333"/>
                    <TextBlock Text="{Binding FullName}" 
                               FontSize="14"
                               FontWeight="SemiBold"
                               Foreground="#333333"/>
                </StackPanel>
            </Border>

            <!-- Menu Items -->
            <StackPanel>
                <!-- Change Password Button -->
                <Button Style="{StaticResource MenuButtonStyle}"
                        Command="{Binding ChangePasswordCommand}">
                    <StackPanel Orientation="Horizontal">
                        <!-- Icon -->
                        <Path Data="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"
                              Fill="#2196F3"
                              Width="18"
                              Height="18"
                              Stretch="Uniform"
                              Margin="0,0,12,0"/>

                        <TextBlock Text="Đổi mật khẩu" 
                                 FontSize="14"
                                 Foreground="#333333"/>
                    </StackPanel>
                </Button>

                <!-- Separator -->
                <Separator Margin="10,5" Background="#E0E0E0"/>

                <!-- Logout Button -->
                <Button Style="{StaticResource MenuButtonStyle}"
                        Command="{Binding LogoutCommand}">
                    <StackPanel Orientation="Horizontal">
                        <!-- Icon -->
                        <Path Data="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z"
                              Fill="#F44336"
                              Width="18"
                              Height="18"
                              Stretch="Uniform"
                              Margin="0,0,12,0"/>

                        <TextBlock Text="Đăng xuất" 
                                 FontSize="14"
                                 Foreground="#333333"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </StackPanel>
    </Border>
</UserControl>
